(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,21982,e=>{"use strict";e.s(["default",()=>F],21982);var s=e.i(43476),a=e.i(71645),t=e.i(7233),r=e.i(87130),l=e.i(16715),i=e.i(61911),n=e.i(75254);let d=(0,n.default)("user-check",[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),c=(0,n.default)("user-x",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);var o=e.i(98919),m=e.i(43432),x=e.i(42920),h=e.i(51199),u=e.i(86536),g=e.i(88511),b=e.i(27612),p=e.i(23585),f=e.i(41071);function j(e){let{user:t,onViewDetail:r,onEdit:l,onDelete:i,variant:n="desktop"}=e,[d,c]=(0,a.useState)(!1),o=(0,a.useRef)(null);(0,a.useEffect)(()=>{function e(e){o.current&&!o.current.contains(e.target)&&c(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);let m=e=>{e(),c(!1)},x=(()=>{let e=[{icon:u.Eye,label:"Lihat Detail",action:()=>m(()=>r(t)),className:"text-blue-600 hover:bg-blue-50"},{icon:g.Edit,label:"Edit User",action:()=>m(()=>l(t)),className:"text-yellow-600 hover:bg-yellow-50"}];return 1!==t.role&&e.push({icon:b.Trash2,label:"Hapus User",action:()=>m(()=>i(t)),className:"text-red-600 hover:bg-red-50"}),e})(),h="mobile"===n?p.MoreVertical:f.MoreHorizontal;return(0,s.jsxs)("div",{className:"relative",ref:o,children:[(0,s.jsx)("button",{onClick:()=>c(!d),className:"p-1 rounded-md hover:bg-gray-100 transition-colors ".concat("mobile"===n?"text-gray-500":"text-gray-400"),title:"Aksi",children:(0,s.jsx)(h,{className:"h-4 w-4"})}),d&&(0,s.jsxs)(s.Fragment,{children:["mobile"===n&&(0,s.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>c(!1)}),(0,s.jsx)("div",{className:"absolute z-50 mt-1 bg-white rounded-md shadow-lg border border-gray-200 ".concat("right-0 origin-top-right"),style:{minWidth:"200px",maxWidth:"mobile"===n?"calc(100vw - 1rem)":"none",right:"0",left:"auto"},children:(0,s.jsx)("div",{className:"py-1",children:x.map((e,a)=>{let t=e.icon;return(0,s.jsxs)("button",{onClick:e.action,className:"w-full flex items-center px-4 py-2 text-sm whitespace-nowrap ".concat(e.className," hover:bg-opacity-10 transition-colors"),children:[(0,s.jsx)(t,{className:"h-4 w-4 mr-3 flex-shrink-0"}),(0,s.jsx)("span",{className:"text-left",children:e.label})]},a)})})})]})]})}var y=e.i(18342),N=e.i(2849),v=e.i(96945),w=e.i(46472),k=e.i(79500),C=e.i(76909),S=e.i(52962),A=e.i(37727),U=e.i(84614);let D=(0,n.default)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]),M=(0,n.default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var I=e.i(46897),L=e.i(64659);let P=e=>{let{isOpen:t,onClose:r,onSubmit:l,mode:i,userData:n}=e,{isSuperAdmin:c,getCurrentBranchId:h}=(0,S.useAuth)(),[u,g]=(0,a.useState)({name:"",email:"",password:"",role:3,phone:"",address:"",position:"",department:"",isActive:!0,branchId:""}),[b,p]=(0,a.useState)(!1),[f,j]=(0,a.useState)({});(0,a.useEffect)(()=>{t&&("edit"===i&&n?g({name:n.name||"",email:n.email||"",password:"",role:n.role||3,phone:n.phone||"",address:n.address||"",position:n.position||"",department:n.department||"",isActive:void 0===n.isActive||n.isActive,branchId:n.branchId||""}):g({name:"",email:"",password:"",role:3,phone:"",address:"",position:"",department:"",isActive:!0,branchId:c()?"":h()||""}),j({}))},[t,i,n]);let y=e=>{let{name:s,value:a,type:t}=e.target;if("phone"===s){let e=a.replace(/[^0-9+\s]/g,"");g(a=>({...a,[s]:e}))}else g(r=>({...r,[s]:"checkbox"===t?e.target.checked:a}));f[s]&&j(e=>({...e,[s]:""}))},N=async e=>{if(e.preventDefault(),(()=>{let e={};return u.name.trim()||(e.name="Nama wajib diisi"),u.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u.email)||(e.email="Format email tidak valid"):e.email="Email wajib diisi","create"!==i||u.password.trim()?"create"===i&&u.password.length<6&&(e.password="Password minimal 6 karakter"):e.password="Password wajib diisi",(!u.role||u.role<1||u.role>3)&&(e.role="Role wajib dipilih"),u.role>1&&!u.branchId&&(e.branchId="Cabang wajib dipilih untuk role Admin dan Operation"),u.phone&&""!==u.phone.trim()&&(/^(\+62|0)?[0-9\s]+$/.test(u.phone.trim())||(e.phone="Nomor telepon harus dimulai dengan +62 atau 0, atau hanya berisi angka")),j(e),0===Object.keys(e).length})()){p(!0);try{if("create"===i)await l(u);else{let e={...u};if(e.password)await l(e);else{let{password:s,...a}=e;await l(a)}}}catch(e){console.error("Error submitting form:",e)}finally{p(!1)}}};return t?(0,s.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,s.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,s.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:r}),(0,s.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:[(0,s.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"create"===i?"Tambah User Baru":"Edit User"}),(0,s.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,s.jsx)(A.X,{className:"h-6 w-6"})})]}),(0,s.jsxs)("form",{onSubmit:N,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(U.User,{className:"h-4 w-4 mr-2 text-blue-600"}),"Nama Lengkap *"]})}),(0,s.jsx)("input",{type:"text",name:"name",value:u.name,onChange:y,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ".concat(f.name?"border-red-300 bg-red-50":"border-gray-300 hover:border-gray-400"),placeholder:"Masukkan nama lengkap"}),f.name&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:f.name})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(D,{className:"h-4 w-4 mr-2 text-blue-600"}),"Email *"]})}),(0,s.jsx)("input",{type:"email",name:"email",value:u.email,onChange:y,disabled:"edit"===i,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ".concat(f.email?"border-red-300 bg-red-50":"border-gray-300 hover:border-gray-400"," ").concat("edit"===i?"bg-gray-100":""),placeholder:"Masukkan email"}),f.email&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:f.email}),"edit"===i&&(0,s.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Email tidak dapat diubah"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:["create"===i&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(M,{className:"h-4 w-4 mr-2 text-blue-600"}),"Password *"]})}),(0,s.jsx)("input",{type:"password",name:"password",value:u.password,onChange:y,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ".concat(f.password?"border-red-300 bg-red-50":"border-gray-300 hover:border-gray-400"),placeholder:"Masukkan password"}),f.password&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:f.password})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(o.Shield,{className:"h-4 w-4 mr-2 text-blue-600"}),"Role *"]})}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("select",{name:"role",value:u.role,onChange:y,className:"w-full appearance-none bg-white border rounded-lg px-4 py-3 pr-8 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ".concat(f.role?"border-red-300 bg-red-50":"border-gray-300 hover:border-gray-400"),children:C.UserService.getRoleOptions().map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,s.jsx)(L.ChevronDown,{className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"})]}),f.role&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:f.role})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.role>1&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(x.Building,{className:"h-4 w-4 mr-2 text-blue-600"}),"Cabang *"]})}),(0,s.jsx)(w.default,{value:u.branchId,onChange:e=>g(s=>({...s,branchId:e})),placeholder:"Pilih cabang...",onlyActive:!0}),f.branchId&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:f.branchId})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(x.Building,{className:"h-4 w-4 mr-2 text-blue-600"}),"Posisi"]})}),(0,s.jsx)("input",{type:"text",name:"position",value:u.position,onChange:y,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors hover:border-gray-400",placeholder:"Masukkan posisi/jabatan"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(x.Building,{className:"h-4 w-4 mr-2 text-blue-600"}),"Departemen"]})}),(0,s.jsx)("input",{type:"text",name:"department",value:u.department,onChange:y,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors hover:border-gray-400",placeholder:"Masukkan departemen"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(m.Phone,{className:"h-4 w-4 mr-2 text-blue-600"}),"Nomor Telepon"]})}),(0,s.jsx)("input",{type:"text",name:"phone",value:u.phone,onChange:y,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors hover:border-gray-400 ".concat(f.phone?"border-red-300 bg-red-50":"border-gray-300"),placeholder:"Masukkan nomor telepon (contoh: +6281234567890 atau 081234567890)"}),f.phone&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:f.phone})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(I.MapPin,{className:"h-4 w-4 mr-2 text-blue-600"}),"Alamat"]})}),(0,s.jsx)("textarea",{name:"address",value:u.address,onChange:y,rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors hover:border-gray-400",placeholder:"Masukkan alamat"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(d,{className:"h-4 w-4 mr-2 text-green-600"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"User aktif"})]}),(0,s.jsx)("button",{type:"button",onClick:()=>g(e=>({...e,isActive:!e.isActive})),className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ".concat(u.isActive?"bg-blue-600":"bg-gray-200"),children:(0,s.jsx)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform ".concat(u.isActive?"translate-x-6":"translate-x-1")})})]})]})]}),(0,s.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,s.jsx)("button",{type:"button",onClick:N,disabled:b,className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50",children:b?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"create"===i?"Menyimpan...":"Memperbarui..."]}):"create"===i?"Simpan":"Perbarui"}),(0,s.jsx)("button",{type:"button",onClick:r,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Batal"})]})]})]})}):null};var E=e.i(87316),R=e.i(3116);let T=e=>{var a,t;let{isOpen:r,onClose:l,userData:i}=e;if(!r||!i)return null;let n=e=>e?new Date(e).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Tidak tersedia";return(0,s.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,s.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,s.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:l}),(0,s.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,s.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Detail User"}),(0,s.jsx)("button",{onClick:l,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,s.jsx)(A.X,{className:"h-6 w-6"})})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4 mb-6",children:[(0,s.jsx)("div",{className:"flex-shrink-0 h-16 w-16",children:(0,s.jsx)("div",{className:"h-16 w-16 rounded-full bg-blue-100 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-2xl font-medium text-blue-600",children:(null==(t=i.name)||null==(a=t.charAt(0))?void 0:a.toUpperCase())||"U"})})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h4",{className:"text-xl font-semibold text-gray-900",children:i.name}),(0,s.jsx)("p",{className:"text-gray-600",children:i.email}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 mt-2",children:[(0,s.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat((e=>{switch(e){case 1:return"bg-red-100 text-red-800";case 2:return"bg-blue-100 text-blue-800";case 3:return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}})(i.role)),children:[(0,s.jsx)(o.Shield,{className:"h-3 w-3 mr-1"}),C.UserService.getRoleDisplayName(i.role)]}),(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(i.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:i.isActive?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d,{className:"h-3 w-3 mr-1"}),"Aktif"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c,{className:"h-3 w-3 mr-1"}),"Nonaktif"]})})]})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,s.jsx)("h5",{className:"text-sm font-medium text-gray-900 mb-3",children:"Informasi Kontak"}),(0,s.jsxs)("div",{className:"space-y-2",children:[i.phone&&(0,s.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,s.jsx)(m.Phone,{className:"h-4 w-4 mr-2 text-gray-400"}),(0,s.jsx)("span",{children:i.phone})]}),i.address&&(0,s.jsxs)("div",{className:"flex items-start text-sm text-gray-600",children:[(0,s.jsx)(I.MapPin,{className:"h-4 w-4 mr-2 mt-0.5 text-gray-400 flex-shrink-0"}),(0,s.jsx)("span",{children:i.address})]})]})]}),(0,s.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,s.jsx)("h5",{className:"text-sm font-medium text-gray-900 mb-3",children:"Informasi Pekerjaan"}),(0,s.jsxs)("div",{className:"space-y-2",children:[i.position&&(0,s.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,s.jsx)(x.Building,{className:"h-4 w-4 mr-2 text-gray-400"}),(0,s.jsx)("span",{children:i.position})]}),i.department&&(0,s.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,s.jsx)(x.Building,{className:"h-4 w-4 mr-2 text-gray-400"}),(0,s.jsx)("span",{children:i.department})]})]})]}),(0,s.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,s.jsx)("h5",{className:"text-sm font-medium text-gray-900 mb-3",children:"Informasi Sistem"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,s.jsx)(E.Calendar,{className:"h-4 w-4 mr-2 text-gray-400"}),(0,s.jsxs)("span",{children:["Dibuat: ",n(i.createdAt)]})]}),i.updatedAt&&(0,s.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,s.jsx)(E.Calendar,{className:"h-4 w-4 mr-2 text-gray-400"}),(0,s.jsxs)("span",{children:["Diperbarui: ",n(i.updatedAt)]})]}),i.lastLogin&&(0,s.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,s.jsx)(R.Clock,{className:"h-4 w-4 mr-2 text-gray-400"}),(0,s.jsxs)("span",{children:["Terakhir login: ",n(i.lastLogin)]})]}),i.createdBy&&(0,s.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,s.jsx)(U.User,{className:"h-4 w-4 mr-2 text-gray-400"}),(0,s.jsxs)("span",{children:["Dibuat oleh: ",i.createdBy]})]}),i.updatedBy&&(0,s.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,s.jsx)(U.User,{className:"h-4 w-4 mr-2 text-gray-400"}),(0,s.jsxs)("span",{children:["Diperbarui oleh: ",i.updatedBy]})]})]})]})]})]}),(0,s.jsx)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:(0,s.jsx)("button",{type:"button",onClick:l,className:"w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:w-auto sm:text-sm",children:"Tutup"})})]})]})})};var O=e.i(78894);let B=e=>{var t,r;let{isOpen:l,onClose:i,onConfirm:n,userData:d}=e,[c,o]=(0,a.useState)(!1),m=async()=>{o(!0);try{await n()}catch(e){console.error("Error deleting user:",e)}finally{o(!1)}};return l&&d?(0,s.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,s.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,s.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:i}),(0,s.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,s.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Konfirmasi Hapus User"}),(0,s.jsx)("button",{onClick:i,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,s.jsx)(A.X,{className:"h-6 w-6"})})]}),(0,s.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)(O.AlertTriangle,{className:"h-6 w-6 text-red-600"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Apakah Anda yakin ingin menghapus user ini?"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Tindakan ini tidak dapat dibatalkan. User akan dihapus dari sistem dan tidak dapat diakses lagi."})]})]}),(0,s.jsx)("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,s.jsx)("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-sm font-medium text-blue-600",children:(null==(r=d.name)||null==(t=r.charAt(0))?void 0:t.toUpperCase())||"U"})})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h5",{className:"text-sm font-medium text-gray-900",children:d.name}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:d.email}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[(0,s.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800",children:[(0,s.jsx)(U.User,{className:"h-3 w-3 mr-1"}),C.UserService.getRoleDisplayName(d.role)]}),d.position&&(0,s.jsx)("span",{className:"text-xs text-gray-500",children:d.position})]})]})]})}),(0,s.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)(O.AlertTriangle,{className:"h-5 w-5 text-yellow-400 mr-2 flex-shrink-0 mt-0.5"}),(0,s.jsxs)("div",{className:"text-sm text-yellow-800",children:[(0,s.jsx)("p",{className:"font-medium mb-1",children:"Peringatan:"}),(0,s.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[(0,s.jsx)("li",{children:"User tidak akan dapat login ke sistem lagi"}),(0,s.jsx)("li",{children:"Semua data terkait user akan dihapus"}),(0,s.jsx)("li",{children:"User dengan role Super Admin tidak dapat dihapus"}),(0,s.jsx)("li",{children:"Tindakan ini bersifat permanen dan tidak dapat dibatalkan"})]})]})]})})]}),(0,s.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,s.jsx)("button",{type:"button",onClick:m,disabled:c||1===d.role,className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:c?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Menghapus..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b.Trash2,{className:"h-4 w-4 mr-2"}),"Hapus User"]})}),(0,s.jsx)("button",{type:"button",onClick:i,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Batal"})]}),1===d.role&&(0,s.jsx)("div",{className:"bg-red-50 border-t border-red-200 px-4 py-3",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(O.AlertTriangle,{className:"h-5 w-5 text-red-400 mr-2"}),(0,s.jsx)("p",{className:"text-sm text-red-800",children:"User dengan role Super Admin tidak dapat dihapus untuk menjaga keamanan sistem."})]})})]})]})}):null},F=()=>{let{user:e,userRole:n,isSuperAdmin:u,getCurrentBranchId:g}=(0,S.useAuth)(),[b,p]=(0,a.useState)([]),[f,A]=(0,a.useState)([]),[U,D]=(0,a.useState)(!0),[M,I]=(0,a.useState)(""),[L,E]=(0,a.useState)("all"),[R,O]=(0,a.useState)("all"),[F,z]=(0,a.useState)("all"),[H,K]=(0,a.useState)(!1),[q,V]=(0,a.useState)(!1),[X,W]=(0,a.useState)(!1),[$,G]=(0,a.useState)(!1),[J,Q]=(0,a.useState)(null),Y=async()=>{try{let e;D(!0),console.log("Loading all users with client-side filtering to avoid index issues");let s=await C.UserService.getUsers();if(u())e=s;else{let a=g();console.log("Current user branch ID:",a),e=a?s.filter(e=>e.branchId===a&&e.role>1):s.filter(e=>e.role>1)}console.log("Loaded users:",e),p(e),A(e)}catch(e){console.error("Error loading users:",e)}finally{D(!1)}};(0,a.useEffect)(()=>{console.log("UserManagementScreen mounted, userRole:",n,"isSuperAdmin:",u()),n&&Y()},[n]),(0,a.useEffect)(()=>{let e=b;M&&(e=e.filter(e=>{var s,a,t;return e.name.toLowerCase().includes(M.toLowerCase())||e.email.toLowerCase().includes(M.toLowerCase())||(null==(s=e.phone)?void 0:s.toLowerCase().includes(M.toLowerCase()))||(null==(a=e.position)?void 0:a.toLowerCase().includes(M.toLowerCase()))||(null==(t=e.department)?void 0:t.toLowerCase().includes(M.toLowerCase()))})),"all"!==L&&(e=e.filter(e=>e.role===parseInt(L))),"all"!==R&&(e=e.filter(e=>"active"===R?e.isActive:!e.isActive)),u()&&"all"!==F&&(e=e.filter(e=>e.branchId===F)),A(e)},[b,M,L,R,F,u]);let Z=async s=>{try{await C.UserService.createUser(s,null==e?void 0:e.uid),await Y(),K(!1)}catch(e){throw console.error("Error creating user:",e),e}},_=async s=>{if(J)try{await C.UserService.updateUser(J.id,s,null==e?void 0:e.uid),await Y(),V(!1),Q(null)}catch(e){throw console.error("Error updating user:",e),e}},ee=async()=>{if(J)try{await C.UserService.deleteUser(J.id),await Y(),G(!1),Q(null)}catch(e){throw console.error("Error deleting user:",e),e}},es=e=>{Q(e),V(!0)},ea=e=>{Q(e),W(!0)},et=e=>{Q(e),G(!0)},er=[{key:"name",label:"Nama",render:(e,a)=>{var t,r;return(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,s.jsx)("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-sm font-medium text-blue-600",children:(null==(r=a.name)||null==(t=r.charAt(0))?void 0:t.toUpperCase())||"U"})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900",children:a.name}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:a.email})]})]})},mobileRender:(e,a)=>(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:a.name||"N/A"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:a.email||"-"})]})},{key:"role",label:"Role",render:e=>{let a=C.UserService.getRoleDisplayName(e);return(0,s.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat({1:"bg-red-100 text-red-800",2:"bg-blue-100 text-blue-800",3:"bg-green-100 text-green-800"}[e]||"bg-gray-100 text-gray-800"),children:[(0,s.jsx)(o.Shield,{className:"h-3 w-3 mr-1"}),a]})},mobileRender:(e,a)=>(0,s.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Role:"}),(0,s.jsxs)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium rounded-full ".concat(1===e?"bg-red-100 text-red-800":2===e?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),children:[(0,s.jsx)(o.Shield,{className:"h-3 w-3 mr-1"}),C.UserService.getRoleDisplayName(e)]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Posisi:"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-900",children:a.position||"-"})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Departemen:"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-900",children:a.department||"-"})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Nomor HP:"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-900",children:a.phone||"-"})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Status:"}),(0,s.jsx)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium rounded-full ".concat(a.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:a.isActive?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d,{className:"h-3 w-3 mr-1"}),"Aktif"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c,{className:"h-3 w-3 mr-1"}),"Nonaktif"]})})]})]}),hideOnMobile:!0},{key:"position",label:"Posisi",render:(e,a)=>(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-gray-900",children:a.position||"-"}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:a.department||""})]}),hideOnMobile:!0},{key:"phone",label:"Kontak",render:(e,a)=>(0,s.jsx)("div",{className:"text-sm text-gray-900",children:a.phone?(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(m.Phone,{className:"h-4 w-4 mr-1 text-gray-400"}),a.phone]}):"-"}),hideOnMobile:!0},{key:"branchId",label:"Cabang",render:(e,a)=>(0,s.jsx)(k.default,{branchId:a.branchId,size:"sm"}),mobileRender:(e,a)=>(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Cabang:"}),(0,s.jsx)(k.default,{branchId:a.branchId,size:"sm",className:"ml-2"})]}),hideOnMobile:!u()},{key:"isActive",label:"Status",render:e=>(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(e?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d,{className:"h-3 w-3 mr-1"}),"Aktif"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c,{className:"h-3 w-3 mr-1"}),"Nonaktif"]})})},{key:"lastLogin",label:"Terakhir Login",render:e=>(0,s.jsx)("div",{className:"text-sm text-gray-900",children:e?new Date(e).toLocaleDateString("id-ID"):"Belum pernah"}),hideOnMobile:!0},{key:"actions",label:"Aksi",render:(e,a)=>(0,s.jsx)(j,{user:a,onViewDetail:ea,onEdit:es,onDelete:et,variant:"desktop"}),mobileRender:(e,a)=>(0,s.jsx)(j,{user:a,onViewDetail:ea,onEdit:es,onDelete:et,variant:"mobile"}),hideOnMobile:!1,align:"center"}],el={total:b.length,active:b.filter(e=>e.isActive).length,inactive:b.filter(e=>!e.isActive).length,superAdmin:b.filter(e=>1===e.role).length,admin:b.filter(e=>2===e.role).length,operation:b.filter(e=>3===e.role).length};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Manajemen User"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Kelola pengguna sistem dan akses mereka"})]}),(0,s.jsxs)("div",{className:"mt-4 sm:mt-0 flex space-x-3",children:[(0,s.jsxs)("button",{onClick:Y,disabled:U,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[(0,s.jsx)(l.RefreshCw,{className:"h-4 w-4 mr-2 ".concat(U?"animate-spin":"")}),"Refresh"]}),(0,s.jsxs)("button",{onClick:()=>K(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,s.jsx)(t.Plus,{className:"h-4 w-4 mr-2"}),"Tambah User"]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border border-gray-100",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)(i.Users,{className:"h-8 w-8 text-blue-600"})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total User"}),(0,s.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:el.total})]})]})}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border border-gray-100",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)(d,{className:"h-8 w-8 text-green-600"})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Aktif"}),(0,s.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:el.active})]})]})}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border border-gray-100",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)(o.Shield,{className:"h-8 w-8 text-red-600"})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Super Admin"}),(0,s.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:el.superAdmin})]})]})}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border border-gray-100",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)(x.Building,{className:"h-8 w-8 text-purple-600"})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Admin + Operation"}),(0,s.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:el.admin+el.operation})]})]})})]}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,s.jsx)(y.SearchField,{value:M,onChange:I,placeholder:"Cari berdasarkan nama, email, atau nomor HP..."}),(0,s.jsx)(N.SelectDropdown,{value:L,onChange:E,options:[{value:"all",label:"Semua Role"},{value:"1",label:"Super Admin"},{value:"2",label:"Admin"},{value:"3",label:"Operation"}],icon:(0,s.jsx)(o.Shield,{className:"h-5 w-5"})}),(0,s.jsx)(N.SelectDropdown,{value:R,onChange:O,options:[{value:"all",label:"Semua Status"},{value:"active",label:"Aktif"},{value:"inactive",label:"Nonaktif"}],icon:(0,s.jsx)(r.Filter,{className:"h-5 w-5"})}),u()&&(0,s.jsx)(w.default,{value:F,onChange:z,showAllOption:!0,placeholder:"Pilih cabang..."})]})}),(0,s.jsx)(h.CustomTable,{data:f,config:{columns:er,showRowNumbers:!0,responsive:!0,loading:U,mobileActionsPosition:"top-right",emptyState:{icon:i.Users,title:"Tidak ada user",description:"Belum ada user yang terdaftar dalam sistem."}},isLoading:U}),(0,s.jsx)(P,{isOpen:H,onClose:()=>K(!1),onSubmit:Z,mode:"create"}),(0,s.jsx)(P,{isOpen:q,onClose:()=>{V(!1),Q(null)},onSubmit:_,mode:"edit",userData:J}),(0,s.jsx)(T,{isOpen:X,onClose:()=>{W(!1),Q(null)},userData:J}),(0,s.jsx)(B,{isOpen:$,onClose:()=>{G(!1),Q(null)},onConfirm:ee,userData:J}),(0,s.jsx)(v.default,{})]})}}]);